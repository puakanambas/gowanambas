<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOW Kabupaten Kepulauan Anambas - Pemberdayaan Wanita, Membangun Negeri</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Leaflet.js untuk Peta Interaktif -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <!-- Chart.js untuk Grafik -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #0f172a; 
            color: #e2e8f0;
        }
        .font-jawi {
            font-family: 'Amiri', serif;
        }
        .header-glass { 
            background: rgba(15, 23, 42, 0.7); 
            backdrop-filter: blur(12px); 
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .hero-bg {
            background-image: linear-gradient(to top, #0f172a 10%, rgba(15, 23, 42, 0.7) 80%), url('https://images.unsplash.com/photo-1529333166437-7750a6dd5a70?q=80&w=2070&auto=format&fit=crop');
            background-size: cover;
            background-position: center center;
        }
        .card-base { 
            background: #1e293b;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        .card-base:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 40px -10px rgba(0, 0, 0, 0.5);
            border-color: rgba(219, 39, 119, 0.5);
        }
        .btn-primary {
            background: linear-gradient(to right, #db2777, #c026d3);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px -5px rgba(219, 39, 119, 0.6);
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px -5px rgba(219, 39, 119, 0.8);
        }
        .fade-in-section {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .fade-in-section.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.5s ease-out; }
        .accordion-button svg { transition: transform 0.3s ease; }
        .accordion-button[aria-expanded="true"] svg { transform: rotate(180deg); }

        .modal-overlay { transition: opacity 0.3s ease; }
        .modal-content { transition: transform 0.3s ease, opacity 0.3s ease; }
        
        .leaflet-container {
            border-radius: 0.75rem;
            border: 1px solid #334155;
        }
        .data-filter-btn {
            background-color: #334155;
            color: #cbd5e1;
            transition: all 0.2s ease-in-out;
        }
        .data-filter-btn.active, .data-filter-btn:hover {
            background: linear-gradient(to right, #db2777, #c026d3);
            color: #fff;
            box-shadow: 0 4px 15px -5px rgba(219, 39, 119, 0.6);
        }
    </style>
</head>
<body class="antialiased">

    <!-- Header -->
    <header id="header" class="header-glass sticky top-0 z-50 transition-all duration-300">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16 sm:h-20">
                <div class="flex-shrink-0">
                    <a href="#" class="flex items-center space-x-2">
                        <img src="https://iili.io/FPZFHv9.png" alt="Logo GOW Anambas" class="h-10 sm:h-12" onerror="this.src='https://placehold.co/150x48/0f172a/e5e7eb?text=GOW+Anambas'">
                    </a>
                </div>
                <div class="flex items-center space-x-2">
                    <nav class="hidden lg:flex space-x-5 text-sm">
                        <a href="#beranda" class="nav-link text-slate-300 hover:text-amber-400 transition-colors">Beranda</a>
                        <a href="#tentang" class="nav-link text-slate-300 hover:text-amber-400 transition-colors">Tentang</a>
                        <a href="#program" class="nav-link text-slate-300 hover:text-amber-400 transition-colors">Program</a>
                        <a href="#data-terpilah" class="nav-link text-slate-300 hover:text-amber-400 transition-colors">Data Terpilah</a>
                        <a href="#pengurus" class="nav-link text-slate-300 hover:text-amber-400 transition-colors">Pengurus</a>
                        <a href="#kegiatan" class="nav-link text-slate-300 hover:text-amber-400 transition-colors">Kegiatan</a>
                        <a href="#simanja" class="nav-link text-slate-300 hover:text-amber-400 transition-colors">SiMANJA</a>
                    </nav>
                    <a href="https://simanjagow.vercel.app/" target="_blank" rel="noopener noreferrer" class="hidden md:inline-block border border-pink-500 text-pink-500 hover:bg-pink-500 hover:text-white transition-colors px-4 py-2 rounded-lg text-sm font-semibold">LOGIN SiMANJA</a>
                    <div class="lg:hidden"><button id="mobile-menu-button" class="text-white focus:outline-none"><i class="fas fa-bars text-xl sm:text-2xl"></i></button></div>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden lg:hidden border-t border-slate-700">
            <a href="#beranda" class="nav-link block py-3 px-4 text-base text-slate-300 hover:bg-slate-700">Beranda</a>
            <a href="#tentang" class="nav-link block py-3 px-4 text-base text-slate-300 hover:bg-slate-700">Tentang Kami</a>
            <a href="#program" class="nav-link block py-3 px-4 text-base text-slate-300 hover:bg-slate-700">Program Kerja</a>
            <a href="#data-terpilah" class="nav-link block py-3 px-4 text-base text-slate-300 hover:bg-slate-700">Data Terpilah</a>
            <a href="#pengurus" class="nav-link block py-3 px-4 text-base text-slate-300 hover:bg-slate-700">Pengurus</a>
            <a href="#kegiatan" class="nav-link block py-3 px-4 text-base text-slate-300 hover:bg-slate-700">Kegiatan</a>
            <a href="#simanja" class="nav-link block py-3 px-4 text-base text-slate-300 hover:bg-slate-700">SiMANJA GOW</a>
            <a href="https://simanjagow.vercel.app/" target="_blank" rel="noopener noreferrer" class="block py-3 px-4 text-base text-pink-400 font-semibold bg-slate-800 hover:bg-slate-700 text-center"><i class="fas fa-rocket w-5 text-center mr-2"></i>LOGIN SiMANJA</a>
        </div>
    </header>

    <main>
        <div id="main-content">
            <section id="beranda" class="hero-bg pt-20 pb-16 md:pt-40 md:pb-28 text-white text-center">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                    <h1 class="text-3xl sm:text-4xl md:text-5xl font-extrabold tracking-wider mb-2" style="text-shadow: 0px 4px 15px rgba(0,0,0,0.7);">GABUNGAN ORGANISASI WANITA</h1>
                    <p class="text-4xl sm:text-5xl md:text-6xl font-extrabold text-pink-400 mb-4">( GOW )</p>
                    <p class="text-xl sm:text-2xl md:text-3xl font-semibold tracking-wide mb-4">KABUPATEN KEPULAUAN ANAMBAS</p>
                    <p class="font-jawi text-3xl sm:text-4xl md:text-5xl mb-4 text-amber-400" dir="rtl">ݢابوڠن اورݢانيساسي وانيتا</p>
                    <p class="text-lg sm:text-xl md:text-2xl font-semibold tracking-wide text-blue-400">THE ASSOCIATION OF WOMEN'S ORGANIZATIONS</p>
                </div>
            </section>

            <section id="statistik" class="py-16 bg-slate-900 fade-in-section">
                <div class="container mx-auto px-4"><div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center"><div class="card-base p-6 rounded-xl"><i class="fas fa-sitemap text-3xl sm:text-4xl text-pink-400 mb-3"></i><p class="text-4xl sm:text-5xl font-bold" id="total-organisasi">0</p><p class="text-slate-400 mt-1">Organisasi Anggota</p></div><div class="card-base p-6 rounded-xl"><i class="fas fa-user-tie text-3xl sm:text-4xl text-amber-400 mb-3"></i><p class="text-4xl sm:text-5xl font-bold" id="total-pengurus">0</p><p class="text-slate-400 mt-1">Total Pengurus</p></div><div class="card-base p-6 rounded-xl"><i class="fas fa-calendar-check text-3xl sm:text-4xl text-blue-400 mb-3"></i><p class="text-4xl sm:text-5xl font-bold" id="total-kegiatan">0</p><p class="text-slate-400 mt-1">Kegiatan Terlaksana</p></div></div></div>
            </section>
            
            <section id="tentang" class="py-16 sm:py-20">
                <div class="container mx-auto px-4">
                    <div class="text-center max-w-3xl mx-auto fade-in-section">
                        <h2 class="text-3xl sm:text-4xl font-bold mb-4">Tentang GOW Anambas</h2>
                        <p class="text-slate-400 mb-12">GOW Kabupaten Kepulauan Anambas resmi berdiri sejak ditetapkannya akta pendirian sebagai wadah permanen yang berasaskan Pancila dan UUD 1945 untuk memperkuat kolaborasi antar organisasi wanita di Anambas.</p>
                    </div>
                    <div class="grid grid-cols-1 lg:grid-cols-5 gap-10 sm:gap-12 items-center fade-in-section">
                        <div class="lg:col-span-2 flex justify-center"><img src="https://iili.io/FPZFHv9.png" alt="Logo GOW Anambas Besar" class="max-w-xs md:max-w-sm" onerror="this.src='https://placehold.co/400x150/0f172a/e5e7eb?text=GOW+Anambas'"></div>
                        <div class="lg:col-span-3 space-y-8">
                            <div><h3 class="text-2xl font-bold mb-4 flex items-center"><i class="fas fa-eye fa-fw mr-3 text-pink-400"></i> Visi</h3><blockquote class="border-l-4 border-pink-500 pl-4 italic text-slate-300 text-justify">"Terwujudnya perempuan Anambas yang berdaya, mandiri, dan berperan aktif dalam mendukung pembangunan Kabupaten Kepulauan Anambas 2025–2030."</blockquote></div>
                            <div><h3 class="text-2xl font-bold mb-4 flex items-center"><i class="fas fa-tasks fa-fw mr-3 text-pink-400"></i> Misi</h3><ul class="space-y-3"><li class="flex items-start space-x-3"><div class="flex-shrink-0 w-6 h-6 rounded-full bg-amber-500/20 text-amber-400 flex items-center justify-center pt-1"><i class="fas fa-lightbulb fa-xs"></i></div><p class="text-slate-400 text-justify">Meningkatkan kapasitas perempuan melalui pendidikan, pelatihan, dan penguatan kewirausahaan.</p></li><li class="flex items-start space-x-3"><div class="flex-shrink-0 w-6 h-6 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center pt-1"><i class="fas fa-users fa-xs"></i></div><p class="text-slate-400 text-justify">Mendorong partisipasi aktif perempuan dalam proses pembangunan daerah.</p></li><li class="flex items-start space-x-3"><div class="flex-shrink-0 w-6 h-6 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center pt-1"><i class="fas fa-heart fa-xs"></i></div><p class="text-slate-400 text-justify">Membina kualitas hidup keluarga dengan fokus pada kesehatan, gizi, dan ketahanan keluarga.</p></li><li class="flex items-start space-x-3"><div class="flex-shrink-0 w-6 h-6 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center pt-1"><i class="fas fa-shield-alt fa-xs"></i></div><p class="text-slate-400 text-justify">Memperjuangkan perlindungan hak perempuan dan anak melalui edukasi dan advokasi.</p></li><li class="flex items-start space-x-3"><div class="flex-shrink-0 w-6 h-6 rounded-full bg-red-500/20 text-red-400 flex items-center justify-center pt-1"><i class="fas fa-handshake fa-xs"></i></div><p class="text-slate-400 text-justify">Membangun sinergi dengan pemerintah daerah dan mitra strategis lainnya.</p></li></ul></div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="program" class="py-16 sm:py-20 bg-slate-900">
                <div class="container mx-auto px-4">
                    <div class="text-center max-w-2xl mx-auto fade-in-section"><h2 class="text-3xl sm:text-4xl font-bold mb-4">Program Kerja GOW 2025-2030</h2><p class="text-slate-400 mb-12">Rencana aksi strategis untuk memberdayakan wanita dan berkontribusi pada pembangunan Kabupaten Kepulauan Anambas.</p></div>
                    <div id="program-kerja-container" class="max-w-4xl mx-auto space-y-4 fade-in-section"></div>
                </div>
            </section>

            <!-- SEKSI DATA TERPILAH BARU -->
            <section id="data-terpilah" class="py-16 sm:py-20">
                <div class="container mx-auto px-4">
                    <div class="text-center max-w-3xl mx-auto fade-in-section">
                        <h2 class="text-3xl sm:text-4xl font-bold mb-4">Data Terpilah: Potret Wanita & Anak di Anambas</h2>
                        <p class="text-slate-400">Data adalah fondasi dari setiap aksi kami. Jelajahi indikator kunci pembangunan manusia di Kepulauan Anambas untuk memahami tantangan dan merayakan kemajuan bersama.</p>
                    </div>
                     <!-- Detail per Kategori -->
                    <div class="max-w-5xl mx-auto fade-in-section mt-16">
                        <h3 class="text-2xl font-bold text-center mb-8">Jelajahi Indikator per Sektor</h3>
                        <div id="data-filter-container" class="flex justify-center flex-wrap gap-3 mb-10">
                            <button data-category="Pendidikan" class="data-filter-btn active font-semibold px-5 py-2 rounded-lg">Pendidikan</button>
                            <button data-category="Kesehatan" class="data-filter-btn font-semibold px-5 py-2 rounded-lg">Kesehatan</button>
                            <button data-category="Ekonomi & Ketenagakerjaan" class="data-filter-btn font-semibold px-5 py-2 rounded-lg">Ekonomi & Ketenagakerjaan</button>
                            <button data-category="Partisipasi Publik" class="data-filter-btn font-semibold px-5 py-2 rounded-lg">Partisipasi Publik</button>
                            <button data-category="Perlindungan Khusus" class="data-filter-btn font-semibold px-5 py-2 rounded-lg">Perlindungan Khusus</button>
                        </div>
                        <div id="data-content-area" class="card-base rounded-xl p-6 md:p-8">
                           <!-- Konten dinamis akan dimuat di sini oleh JS -->
                        </div>
                    </div>
                </div>
            </section>

            <section id="pengurus" class="py-16 sm:py-20 bg-slate-900">
                <div class="container mx-auto px-4">
                    <div class="text-center max-w-2xl mx-auto fade-in-section"><h2 class="text-3xl sm:text-4xl font-bold mb-4">Struktur Pengurus Inti & Organisasi</h2><p class="text-slate-400 mb-12">Motor penggerak dan sinergi kekuatan wanita Anambas yang berdedikasi memajukan peran wanita.</p></div>
                    <h3 class="text-2xl font-bold text-center mb-8 fade-in-section">Pengurus Inti</h3>
                    <div id="pengurus-inti-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-16"><p class="col-span-full text-center text-slate-400">Memuat data pengurus...</p></div>
                    <h3 class="text-2xl font-bold text-center mb-8 fade-in-section">Organisasi Tergabung</h3>
                    <div id="organisasi-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 sm:gap-6"><p class="col-span-full text-center text-slate-400">Memuat data organisasi...</p></div>
                </div>
            </section>
            
            <section id="kegiatan" class="py-16 sm:py-20">
                <div class="container mx-auto px-4">
                    <div class="text-center max-w-2xl mx-auto fade-in-section"><h2 class="text-3xl sm:text-4xl font-bold mb-4">Galeri Kegiatan</h2><p class="text-slate-400">Dokumentasi aksi dan kontribusi nyata kami untuk masyarakat Kepulauan Anambas.</p></div>
                    <div class="my-12 max-w-2xl mx-auto flex flex-col sm:flex-row gap-4 fade-in-section"><div class="relative flex-grow"><input type="search" id="search-kegiatan" placeholder="Cari nama kegiatan..." class="w-full bg-slate-800 border border-slate-700 rounded-lg py-2 pl-10 pr-4 text-white focus:ring-2 focus:ring-pink-500 focus:outline-none transition-colors"><i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"></i></div><select id="filter-tahun" class="bg-slate-800 border border-slate-700 rounded-lg py-2 px-4 text-white focus:ring-2 focus:ring-pink-500 focus:outline-none transition-colors"><option value="">Semua Tahun</option></select></div>
                    <div id="kegiatan-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"><p class="col-span-full text-center text-slate-400">Memuat data kegiatan...</p></div>
                </div>
            </section>
            
            <section id="simanja" class="py-16 sm:py-20 bg-slate-900">
                <div class="container mx-auto px-4"><div class="max-w-3xl mx-auto text-center fade-in-section"><h2 class="text-3xl sm:text-4xl font-bold mb-4">Platform Digital SiMANJA GOW</h2><p class="text-slate-400 mb-6 leading-relaxed">Sebagai wujud inovasi, GOW Anambas menghadirkan <strong class="font-semibold text-white">SiMANJA</strong> (Sistem Informasi Manajemen Jaringan GOW), sebuah platform digital eksklusif yang dirancang untuk memperkuat sinergi dan efektivitas organisasi. Platform ini berfungsi sebagai pusat data terpadu, memudahkan koordinasi program, serta mendukung tata kelola modern melalui digitalisasi administrasi.</p><a href="https://simanjagow.vercel.app/" target="_blank" rel="noopener noreferrer" class="btn-primary inline-block px-8 py-3 rounded-lg font-semibold mt-4"><i class="fas fa-sign-in-alt mr-2"></i> Login ke SiMANJA GOW</a></div></div>
            </section>
        </div>

        <div id="detail-content" class="hidden"></div>
    </main>
    
    <div id="modal-placeholder"></div>

    <footer id="kontak" class="bg-slate-800 border-t border-slate-700">
        <div class="container mx-auto px-4 py-8"><div class="text-center text-slate-400 text-sm"><div class="flex justify-center items-center gap-6 mb-4"><a href="https://www.instagram.com/gow_anambaskab" target="_blank" class="text-slate-400 hover:text-pink-400 transition-colors"><i class="fab fa-instagram text-2xl"></i></a><a href="https://www.facebook.com/share/14JrYrAff1V/" target="_blank" class="text-slate-400 hover:text-pink-400 transition-colors"><i class="fab fa-facebook text-2xl"></i></a><a href="mailto:gow.anambas@gmail.com" class="text-slate-400 hover:text-pink-400 transition-colors"><i class="fas fa-envelope text-2xl"></i></a></div><p class="mb-2"><i class="fas fa-map-marker-alt mr-2"></i>Jl. Kartini RT.04/RW.04 Tarempa, Kecamatan Siantan, Kode Pos 29791</p><p>&copy; <span id="copyright-year"></span> GOW KKA. All Rights Reserved.</p></div></div>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, onSnapshot, query, orderBy, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        const firebaseConfig = { apiKey: "AIzaSyAboBugSdtduTa4MIAeQXFkM8QHdah8lcQ", authDomain: "simanja-gow-app.firebaseapp.com", projectId: "simanja-gow-app", storageBucket: "simanja-gow-app.appspot.com", messagingSenderId: "307105555893", appId: "1:307105555893:web:e5470c451f5c4fdacea5fc" };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- Variabel Global & Kontrol Halaman ---
        const mainContent = document.getElementById('main-content');
        const detailContent = document.getElementById('detail-content');
        let allKegiatan = [];
        let dataChart = null; 
        const showMainPage = () => { mainContent.classList.remove('hidden'); detailContent.classList.add('hidden'); window.scrollTo(0, 0); };
        const showDetailPage = () => { mainContent.classList.add('hidden'); detailContent.classList.remove('hidden'); window.scrollTo(0, 0); };
        
        // --- PROFIL ORGANISASI (untuk modal) ---
        const organisasiProfiles = { "PKK": "Gerakan nasional yang bertujuan memberdayakan keluarga...", "DWP": "Organisasi kemasyarakatan yang menghimpun istri Aparatur Sipil Negara...", "IKIAD": "Wadah bagi istri-istri anggota DPRD...", "JALASENASTRI": "Organisasi istri anggota TNI Angkatan Laut...", "BHAYANGKARI": "Organisasi persatuan istri anggota POLRI...", "PERSIT KARTIKA CHANDRA KIRANA": "Organisasi istri prajurit TNI Angkatan Darat...", "DWP KEMENAG": "Bagian dari Dharma Wanita Persatuan di bawah Kementerian Agama...", "DHARMAYUKTI KARINI": "Organisasi wanita di lingkungan Mahkamah Agung...", "IKATAN ADHYAKSA DHARMAKARINI": "Organisasi persatuan istri para pegawai Kejaksaan...", "IAD": "Organisasi persatuan istri para pegawai Kejaksaan...", "PGRI": "Organisasi profesi yang menaungi para guru...", "BKMT": "Wadah yang menghimpun majelis-majelis taklim...", "IBI": "Organisasi profesi bagi para bidan...", "PSMTI": "Organisasi sosial kemasyarakatan bagi warga Tionghoa...", "REDAT SRI TANJUNG": "Organisasi yang fokus pada pelestarian seni dan budaya Melayu...", "SALIMAH": "Organisasi massa yang peduli terhadap perempuan, anak, dan keluarga...", "FPPI": "Sebuah forum yang berjuang untuk pemberdayaan perempuan..." };

        // --- FUNGSI PEMUAT DATA ---
        const loadStatistik = () => { const els = { organisasi: document.getElementById('total-organisasi'), pengurus: document.getElementById('total-pengurus'), kegiatan: document.getElementById('total-kegiatan') }; onSnapshot(collection(db, 'organisasi'), (snap) => { els.organisasi.textContent = snap.size; }); onSnapshot(collection(db, 'pengurus'), (snap) => { els.pengurus.textContent = snap.size; }); onSnapshot(collection(db, 'kegiatan'), (snap) => { els.kegiatan.textContent = snap.size; }); };
        const loadPengurusInti = () => { const grid = document.getElementById('pengurus-inti-grid'); if (!grid) return; const q = query(collection(db, 'pengurus'), orderBy("createdAt", "asc")); onSnapshot(q, (snapshot) => { const pengurusInti = snapshot.docs.filter(doc => doc.data().kategori === 'inti'); if (pengurusInti.length === 0) { grid.innerHTML = '<p class="col-span-full text-center text-slate-400">Data pengurus inti belum tersedia.</p>'; return; } grid.innerHTML = pengurusInti.map(doc => { const p = doc.data(); const avatar = p.foto ? `<img src="${p.foto}" class="w-24 h-24 sm:w-28 sm:h-28 rounded-full object-cover mx-auto mb-4 border-4 border-slate-700" onerror="this.src='https://placehold.co/112x112/334155/e5e7eb?text=${p.nama.charAt(0)}'">` : `<div class="w-24 h-24 sm:w-28 sm:h-28 rounded-full bg-gradient-to-br from-pink-500 to-fuchsia-600 flex items-center justify-center mx-auto mb-4 border-4 border-slate-700"><span class="text-3xl sm:text-4xl font-bold">${p.nama.charAt(0)}</span></div>`; return `<div class="card-base text-center p-6 rounded-xl fade-in-section">${avatar}<h3 class="text-xl font-bold">${p.nama}</h3><p class="text-amber-400">${p.jabatan}</p></div>`; }).join(''); observeSections(); }); };
        const loadKegiatan = () => { const q = query(collection(db, 'kegiatan'), orderBy("tanggal", "desc")); onSnapshot(q, (snapshot) => { allKegiatan = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })); const filterTahun = document.getElementById('filter-tahun'); const years = [...new Set(allKegiatan.map(k => k.tanggal ? new Date(k.tanggal).getFullYear() : null).filter(Boolean))]; filterTahun.innerHTML = '<option value="">Semua Tahun</option>'; years.sort((a, b) => b - a).forEach(year => { filterTahun.innerHTML += `<option value="${year}">${year}</option>`; }); applyFilters(); }); };
        const loadOrganisasi = () => { const grid = document.getElementById('organisasi-grid'); if(!grid) return; const q = query(collection(db, 'organisasi'), orderBy("nama", "asc")); onSnapshot(q, (snapshot) => { if (snapshot.empty) { grid.innerHTML = '<p class="col-span-full text-center text-slate-400">Data organisasi belum tersedia.</p>'; return; } grid.innerHTML = snapshot.docs.map(doc => { const org = doc.data(); const id = doc.id; const logoHtml = org.logo ? `<img src="${org.logo}" class="w-full h-full object-contain" onerror="this.parentElement.innerHTML = '<i class=\\'fas fa-sitemap text-3xl text-slate-500\\'></i>'">` : `<i class="fas fa-sitemap text-3xl text-slate-500"></i>`; return `<button data-org-id="${id}" class="org-card card-base text-center p-3 sm:p-4 rounded-xl flex flex-col items-center justify-center fade-in-section h-36 sm:h-40"><div class="w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-slate-800 flex items-center justify-center mb-3 overflow-hidden p-2">${logoHtml}</div><h4 class="font-semibold text-xs sm:text-sm leading-tight line-clamp-2">${org.nama}</h4></button>`; }).join(''); observeSections(); document.querySelectorAll('.org-card').forEach(card => card.addEventListener('click', () => renderOrganisasiDetail(card.dataset.orgId))); }); };
        const loadProgramKerja = () => { const container = document.getElementById('program-kerja-container'); const dataProgram = [ { bidang: 'ORGANISASI DAN KADERISASI', icon: 'fa-users', programs: [{ name: 'Pelatihan Tata Boga', tujuan: 'Meningkatkan dan menguatkan kapasitas serta keterampilan sumber daya internal organisasi.', sasaran: 'Anggota GOW' }] }, { bidang: 'PENDIDIKAN, IPTEK DAN SOSIAL BUDAYA', icon: 'fa-graduation-cap', programs: [{ name: 'Peningkatan Keterampilan Kelompok Rentan (Lansia)', tujuan: 'Meningkatkan kemampuan dan keterampilan kelompok binaan (lansia) di Kecamatan Siantan & Palmatak.', sasaran: 'Lansia Buta Aksara (Usia 50+)' }, { name: 'Literasi Gemar Membaca', tujuan: 'Meningkatkan minat baca peserta didik dari tingkat PAUD hingga SMP.', sasaran: 'Peserta Didik (PAUD s/d SMP)' }, { name: 'Pusat Kreativitas Anak (PKA)', tujuan: 'Memanfaatkan waktu luang untuk kegiatan anak yang positif, kreatif, dan produktif.', sasaran: 'Masyarakat saat Minggu Energi Baru (MEB) Day' }] }, { bidang: 'KESEHATAN & KELUARGA BERENCANA', icon: 'fa-heartbeat', programs: [{ name: 'Pojok ASI (Ruang Laktasi)', tujuan: 'Menyediakan fasilitas responsif bagi Ibu Menyusui di area publik.', sasaran: 'Perkantoran & Tempat Umum' }, { name: 'SINTA LASKAR Sehat', tujuan: 'Program pendampingan anak stunting selama 56 hari dengan intervensi gizi.', sasaran: '39 Anak Stunting di Kecamatan Siantan' }, { name: 'Motorcycle Free Day (MFD)', tujuan: 'Menciptakan area bebas kendaraan untuk kegiatan kesehatan masyarakat.', sasaran: 'Masyarakat (Minggu ke-2 setiap bulan)' }] }, { bidang: 'KEAGAMAAN DAN MORAL', icon: 'fa-quran', programs: [{ name: 'Maghrib Mengaji', tujuan: 'Partisipasi aktif anggota GOW dalam kegiatan mengaji bersama.', sasaran: 'Anggota GOW' }, { name: 'Pelatihan Fardhu Kifayah', tujuan: 'Regenerasi dan peningkatan kemampuan masyarakat dalam mengurus jenazah.', sasaran: 'Daerah yang kekurangan tenaga kepengurusan jenazah' }] }, { bidang: 'EKONOMI, KOPERASI & KETENAGAKERJAAN', icon: 'fa-briefcase', programs: [{ name: 'Pembinaan UMKM', tujuan: 'Mendorong kemandirian ekonomi perempuan melalui pelatihan dan pendampingan.', sasaran: 'UMKM' }, { name: 'Gerai GOW', tujuan: 'Menjadi wadah untuk menunjang UMKM melalui kolaborasi dengan Dekranasda dan PLUD.', sasaran: 'UMKM' }, { name: 'Koperasi GOW', tujuan: 'Membuka lapangan kerja dan mempermudah transaksi bagi ASN melalui kantin.', sasaran: 'ASN & Masyarakat' }] }, { bidang: 'INFORMASI, KOMUNIKASI DAN HUMAS', icon: 'fa-bullhorn', programs: [{ name: 'Publikasi dan Dokumentasi', tujuan: 'Mempublikasikan semua kegiatan GOW melalui media sosial.', sasaran: 'Masyarakat' }, { name: 'GOW Podcast', tujuan: 'Membuat podcast edukatif dan informatif dengan tema-tema variatif.', sasaran: 'Masyarakat' }, { name: 'Lomba Video Kreatif Digital', tujuan: 'Menumbuhkan dan meningkatkan kreativitas digital masyarakat.', sasaran: 'Masyarakat' }] }, { bidang: 'HUKUM, HAM DAN KESETARAAN GENDER', icon: 'fa-balance-scale', programs: [{ name: 'Event Hari Ibu', tujuan: 'Memberikan wadah bagi masyarakat yang berkontribusi dalam kesetaraan gender.', sasaran: 'Organisasi-organisasi wanita' }, { name: 'GOW GOES TO SCHOOL', tujuan: 'Edukasi pencegahan kekerasan pada anak, pernikahan dini, dan kenakalan remaja.', sasaran: 'Sekolah-sekolah' }] } ]; container.innerHTML = dataProgram.map((bidang) => ` <div class="card-base rounded-lg"> <h2><button class="accordion-button flex justify-between items-center w-full p-4 sm:p-5 text-left font-semibold" aria-expanded="false"><div class="flex items-center text-base sm:text-lg"><i class="fas ${bidang.icon} w-6 text-center mr-4 text-pink-400"></i><span>${bidang.bidang}</span></div><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></h2> <div class="accordion-content bg-slate-800/50 rounded-b-lg"> <div class="p-4 sm:p-5 border-t border-slate-700 divide-y divide-slate-700"> ${bidang.programs.map(prog => ` <div class="py-4 first:pt-0 last:pb-0"> <h4 class="font-semibold text-white">${prog.name}</h4> <div class="mt-2 pl-2 border-l-2 border-amber-400"><p class="text-sm text-slate-300"><strong class="font-semibold text-amber-400">Tujuan:</strong> ${prog.tujuan}</p></div> <div class="mt-2 pl-2 border-l-2 border-blue-400"><p class="text-sm text-slate-300"><strong class="font-semibold text-blue-400">Sasaran:</strong> ${prog.sasaran}</p></div> </div>`).join('')} </div> </div> </div>`).join(''); container.querySelectorAll('.accordion-button').forEach(button => { button.addEventListener('click', () => { const expanded = button.getAttribute('aria-expanded') === 'true'; button.setAttribute('aria-expanded', !expanded); const content = button.parentElement.nextElementSibling; content.style.maxHeight = expanded ? '0px' : content.scrollHeight + 'px'; }); }); };

        // --- FUNGSI RENDER & INTERAKSI UI ---
        const renderKegiatanGrid = (kegiatanList) => { const grid = document.getElementById('kegiatan-grid'); if (kegiatanList.length === 0) { grid.innerHTML = `<p class="col-span-full text-center text-slate-400">Tidak ada kegiatan yang cocok.</p>`; return; } grid.innerHTML = kegiatanList.map(k => { const tanggal = k.tanggal ? new Date(k.tanggal).toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' }) : ''; return `<a href="#/kegiatan/${k.id}" class="card-base rounded-xl overflow-hidden group kegiatan-card fade-in-section"><div class="overflow-hidden h-56"><img src="${k.foto}" class="w-full h-full object-cover group-hover:scale-105 transition-transform" onerror="this.src='https://placehold.co/600x400/334155/e5e7eb?text=Kegiatan'"></div><div class="p-6"><p class="text-sm text-slate-400 mb-2"><i class="fas fa-calendar-alt mr-2"></i>${tanggal}</p><h3 class="text-xl font-bold mb-3 h-20 line-clamp-3">${k.nama}</h3><p class="text-blue-400 text-sm"><i class="fas fa-map-marker-alt mr-2"></i>${k.lokasi}</p></div></a>`; }).join(''); observeSections(); };
        const applyFilters = () => { const searchTerm = document.getElementById('search-kegiatan').value.toLowerCase(); const selectedYear = document.getElementById('filter-tahun').value; let filteredKegiatan = allKegiatan.filter(k => (!searchTerm || k.nama.toLowerCase().includes(searchTerm)) && (!selectedYear || (k.tanggal && new Date(k.tanggal).getFullYear() == selectedYear))); renderKegiatanGrid(filteredKegiatan); };
        const renderDetailPage = async (kegiatanId) => { showDetailPage(); detailContent.innerHTML = `<div class="text-center py-40"><p class="text-slate-400">Memuat detail...</p></div>`; try { const docRef = doc(db, 'kegiatan', kegiatanId); const docSnap = await getDoc(docRef); if (docSnap.exists()) { const data = docSnap.data(); const tanggal = data.tanggal ? new Date(data.tanggal).toLocaleDateString('id-ID', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' }) : 'N/A'; const mapHtml = (data.koordinat?.lat && data.koordinat?.lng) ? `<h3 class="text-2xl font-bold mt-12 mb-4">Peta Lokasi</h3><div id="map" class="w-full h-80 z-0"></div>` : ''; detailContent.innerHTML = `<article class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12"><div class="max-w-3xl mx-auto"><div class="mb-6 sm:mb-8"><a href="#" class="nav-link text-pink-400 hover:text-pink-300"><i class="fas fa-arrow-left mr-2"></i>Kembali ke Beranda</a></div><h1 class="text-3xl sm:text-4xl md:text-5xl font-extrabold text-white leading-tight mb-4">${data.nama}</h1><div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-6 text-slate-400 mb-6 border-b border-slate-700 pb-6"><span><i class="fas fa-calendar-alt mr-2 text-amber-400"></i>${tanggal}</span><span><i class="fas fa-map-marker-alt mr-2 text-blue-400"></i>${data.lokasi || 'N/A'}</span></div><img src="${data.foto}" alt="${data.nama}" class="w-full rounded-xl mb-8" onerror="this.style.display='none'"><div class="prose prose-invert max-w-none text-slate-300 leading-relaxed text-justify whitespace-pre-line">${data.deskripsi || ''}</div>${mapHtml}</div></article>`; if (data.koordinat?.lat && data.koordinat?.lng) { setTimeout(() => { const map = L.map('map').setView([data.koordinat.lat, data.koordinat.lng], 15); L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: '© OpenStreetMap' }).addTo(map); L.marker([data.koordinat.lat, data.koordinat.lng]).addTo(map).bindPopup(`<b>${data.nama}</b>`).openPopup(); }, 100); } } else { detailContent.innerHTML = `<div class="text-center py-40 px-4"><h2 class="text-2xl font-bold">404 - Tidak Ditemukan</h2><p class="text-slate-400 mt-4">Kegiatan ini tidak ditemukan.</p><a href="#" class="nav-link mt-8 inline-block btn-primary px-6 py-3 rounded-lg">Kembali</a></div>`; } } catch (error) { detailContent.innerHTML = `<div class="text-center py-40 px-4"><h2 class="text-2xl font-bold text-red-400">Gagal Memuat</h2><p class="text-slate-400 mt-4">Terjadi kesalahan saat mengambil data.</p><a href="#" class="nav-link mt-8 inline-block btn-primary px-6 py-3 rounded-lg">Kembali</a></div>`; } };
        const renderOrganisasiDetail = async (orgId) => { const placeholder = document.getElementById('modal-placeholder'); const docRef = doc(db, 'organisasi', orgId); const docSnap = await getDoc(docRef); if (docSnap.exists()) { const org = docSnap.data(); const ketua = org.infoKetua || {}; const profile = organisasiProfiles[org.nama.toUpperCase().replace(/\s/g, '')] || organisasiProfiles[org.nama] || "Informasi profil belum tersedia."; const avatar = ketua.foto ? `<img src="${ketua.foto}" class="w-20 h-20 rounded-full object-cover border-4 border-slate-700" onerror="this.src='https://placehold.co/80x80/ec4899/ffffff?text=${(ketua.nama || '?').charAt(0)}'">` : `<div class="w-20 h-20 rounded-full bg-pink-500 flex items-center justify-center text-3xl font-bold border-4 border-slate-700">${(ketua.nama || '?').charAt(0)}</div>`; const modalHTML = ` <div id="org-modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-4 z-[100] opacity-0 modal-overlay"> <div class="bg-slate-800 border border-slate-700 rounded-xl w-full max-w-lg p-6 transform scale-95 opacity-0 modal-content"> <div class="flex flex-col sm:flex-row items-center text-center sm:text-left gap-5"> <img src="${org.logo || 'https://placehold.co/96x96/1e293b/e2e8f0?text=Logo'}" class="w-24 h-24 object-contain" onerror="this.src='https://placehold.co/96x96/1e293b/e2e8f0?text=Logo'"> <div> <h2 class="text-2xl font-bold text-white">${org.nama}</h2> <p class="text-slate-400 text-sm mt-3 text-justify">${profile}</p> </div> </div> <div class="my-6 border-t border-slate-700"></div> <h3 class="font-semibold text-lg mb-4 text-center">Dipimpin oleh:</h3> <div class="flex items-center justify-center space-x-4"> ${avatar} <div><p class="font-bold text-xl text-amber-400">${ketua.nama || '-'}</p><p class="text-slate-300">Ketua Organisasi</p></div> </div> <div class="text-center"> <button id="close-modal-btn" class="mt-8 bg-pink-600/20 text-pink-400 hover:bg-pink-600 hover:text-white transition-colors px-6 py-2 rounded-lg">Tutup</button> </div> </div> </div>`; placeholder.innerHTML = modalHTML; const modal = document.getElementById('org-modal'); const modalContent = modal.querySelector('.modal-content'); requestAnimationFrame(() => { modal.classList.remove('opacity-0'); modalContent.classList.remove('scale-95', 'opacity-0'); }); const closeModal = () => { modal.classList.add('opacity-0'); modalContent.classList.add('scale-95', 'opacity-0'); setTimeout(() => placeholder.innerHTML = '', 300); }; modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); }); document.getElementById('close-modal-btn').addEventListener('click', closeModal); } };
        
        // --- LOGIKA UNTUK DATA TERPILAH ---
        const kecamatanList = ['Siantan', 'Siantan Selatan', 'Siantan Timur', 'Palmatak', 'Jemaja', 'Jemaja Barat', 'Jemaja Timur', 'Kute Siantan', 'Siantan Tengah', 'Siantan Utara'];
        
        const fullDataByCategory = {
            'Pendidikan': {
                sumber: 'Sumber: BPS Kab. Kepulauan Anambas, "Potret Pendidikan 2024" (Data Simulasi)',
                indicators: {
                    'Angka Partisipasi Sekolah (APS)': {
                        wawasan: { default: '<p>💡 Kesenjangan partisipasi sekolah SMP antara gender hampir tidak ada, ini adalah pencapaian positif untuk seluruh kabupaten.</p>', 'Palmatak': '<p>💡 Kecamatan Palmatak menunjukkan angka partisipasi sedikit lebih rendah untuk anak perempuan, menandakan area ini perlu menjadi fokus program literasi GOW.</p>'},
                        datasets: [{ label: 'Laki-laki (%)', color: 'rgba(59, 130, 246, 0.7)' }, { label: 'Perempuan (%)', color: 'rgba(236, 72, 153, 0.7)' }],
                        data: { 'Siantan': [98.8, 98.7], 'Siantan Selatan': [98.5, 98.4], 'Siantan Timur': [99.1, 99.0], 'Palmatak': [98.2, 97.9], 'Jemaja': [99.0, 98.9], 'Jemaja Barat': [98.7, 98.5], 'Jemaja Timur': [98.9, 98.8], 'Kute Siantan': [98.4, 98.2], 'Siantan Tengah': [98.6, 98.5], 'Siantan Utara': [99.2, 99.1] }
                    },
                    'Angka Melek Huruf': {
                        wawasan: { default: '<p>💡 Angka melek huruf di atas 15 tahun sudah sangat tinggi di seluruh Anambas, menunjukkan keberhasilan program pendidikan dasar.</p>'},
                        datasets: [{ label: 'Laki-laki (%)', color: 'rgba(59, 130, 246, 0.7)' }, { label: 'Perempuan (%)', color: 'rgba(236, 72, 153, 0.7)' }],
                        data: { 'Siantan': [99.5, 99.3], 'Siantan Selatan': [99.2, 99.1], 'Siantan Timur': [99.6, 99.5], 'Palmatak': [98.9, 98.5], 'Jemaja': [99.4, 99.2], 'Jemaja Barat': [99.3, 99.1], 'Jemaja Timur': [99.5, 99.4], 'Kute Siantan': [99.0, 98.8], 'Siantan Tengah': [99.1, 99.0], 'Siantan Utara': [99.7, 99.6] }
                    }
                }
            },
            'Kesehatan': {
                sumber: 'Sumber: Dinkes PPKB Kab. Kepulauan Anambas, "Laporan Tahunan 2024" (Data Simulasi)',
                indicators: {
                    'AKI & AKB': {
                        wawasan: { default: '<p>💡 Angka Kematian Ibu (AKI) dan Bayi (AKB) relatif rendah, namun tetap memerlukan pemantauan ketat di fasilitas kesehatan primer.</p>'},
                        datasets: [{ label: 'AKI (per 100.000 KH)', color: 'rgba(236, 72, 153, 0.7)' }, { label: 'AKB (per 1.000 KH)', color: 'rgba(245, 158, 11, 0.7)' }],
                        data: { 'Siantan': [1, 5], 'Siantan Selatan': [0, 7], 'Siantan Timur': [0, 4], 'Palmatak': [1, 8], 'Jemaja': [0, 3], 'Jemaja Barat': [0, 5], 'Jemaja Timur': [0, 4], 'Kute Siantan': [1, 9], 'Siantan Tengah': [0, 6], 'Siantan Utara': [0, 3] }
                    },
                    'Prevalensi Stunting': {
                        wawasan: { default: '<p>💡 Penurunan angka stunting menunjukkan keberhasilan program intervensi gizi.</p>', 'Jemaja': '<p>💡 Kecamatan Jemaja berhasil menekan angka stunting paling signifikan, menjadi contoh praktik baik.</p>'},
                        datasets: [{ label: 'Stunting (%)', color: 'rgba(245, 158, 11, 0.7)' }],
                        data: { 'Siantan': [22.1], 'Siantan Selatan': [23.5], 'Siantan Timur': [21.8], 'Palmatak': [24.1], 'Jemaja': [19.8], 'Jemaja Barat': [22.5], 'Jemaja Timur': [20.9], 'Kute Siantan': [23.8], 'Siantan Tengah': [22.7], 'Siantan Utara': [21.2] }
                    }
                }
            },
            'Ekonomi & Ketenagakerjaan': {
                sumber: 'Sumber: Dinas KUKM Perindag, "Survei Tenaga Kerja 2024" (Data Simulasi)',
                 indicators: {
                    'Tingkat Partisipasi Angkatan Kerja': {
                        wawasan: { default: '<p>💡 Terdapat kesenjangan partisipasi angkatan kerja antara laki-laki dan perempuan. Program pemberdayaan ekonomi GOW bertujuan mengurangi kesenjangan ini.</p>'},
                        datasets: [{ label: 'Laki-laki (%)', color: 'rgba(59, 130, 246, 0.7)' }, { label: 'Perempuan (%)', color: 'rgba(236, 72, 153, 0.7)' }],
                        data: { 'Siantan': [82.1, 48.5], 'Siantan Selatan': [81.5, 45.2], 'Siantan Timur': [83.0, 49.1], 'Palmatak': [80.2, 43.1], 'Jemaja': [84.1, 50.2], 'Jemaja Barat': [83.5, 49.5], 'Jemaja Timur': [83.8, 49.8], 'Kute Siantan': [79.9, 42.5], 'Siantan Tengah': [81.0, 44.5], 'Siantan Utara': [85.2, 51.5] }
                    },
                    'Jumlah UMKM Dikelola Perempuan': {
                        wawasan: { default: '<p>💡 Jumlah UMKM yang dikelola perempuan menunjukkan peran vital mereka dalam ekonomi lokal, terutama di sektor kuliner dan kerajinan.</p>'},
                        datasets: [{ label: 'Jumlah UMKM', color: 'rgba(16, 185, 129, 0.7)' }],
                        data: { 'Siantan': [250], 'Siantan Selatan': [180], 'Siantan Timur': [210], 'Palmatak': [150], 'Jemaja': [280], 'Jemaja Barat': [260], 'Jemaja Timur': [270], 'Kute Siantan': [130], 'Siantan Tengah': [160], 'Siantan Utara': [320] }
                    }
                }
            },
            'Partisipasi Publik': {
                 sumber: 'Sumber: DINSOSP3A, "Laporan Partisipasi Publik 2024" (Data Simulasi)',
                 indicators: {
                    'Keterlibatan Perempuan dalam Musrenbang': {
                         wawasan: { default: '<p>💡 Rata-rata kabupaten melampaui kuota 30% keterwakilan perempuan, sebuah capaian yang membanggakan.</p>', 'Siantan': '<p>💡 Kecamatan Siantan memiliki partisipasi perempuan di Musrenbangdes tertinggi, menjadi praktik baik yang bisa direplikasi.</p>'},
                        datasets: [{ label: 'Partisipasi Perempuan (%)', color: 'rgba(139, 92, 246, 0.7)' }],
                        data: { 'Siantan': [41.2], 'Siantan Selatan': [35.8], 'Siantan Timur': [38.9], 'Palmatak': [29.7], 'Jemaja': [39.5], 'Jemaja Barat': [34.1], 'Jemaja Timur': [37.6], 'Kute Siantan': [28.9], 'Siantan Tengah': [36.3], 'Siantan Utara': [40.1] }
                    }
                 }
            },
            'Perlindungan Khusus': {
                 sumber: 'Sumber: Laporan UPTD PPA Kab. Kepulauan Anambas, 2024 (Data Simulasi)',
                 indicators: {
                    'Jumlah Kasus KtPA': {
                        wawasan: { default: '<p>💡 Jumlah kasus yang dilaporkan menunjukkan meningkatnya kesadaran masyarakat untuk melapor. GOW terus berkomitmen melakukan edukasi dan pendampingan.</p>'},
                        datasets: [{ label: 'Jumlah Kasus', color: 'rgba(239, 68, 68, 0.7)' }],
                        data: { 'Siantan': [7], 'Siantan Selatan': [4], 'Siantan Timur': [5], 'Palmatak': [8], 'Jemaja': [3], 'Jemaja Barat': [2], 'Jemaja Timur': [3], 'Kute Siantan': [6], 'Siantan Tengah': [5], 'Siantan Utara': [9] }
                    },
                    'Prevalensi Perkawinan Anak': {
                         wawasan: { default: '<p>💡 Angka perkawinan anak menjadi perhatian serius. Program GOW Goes to School menjadi salah satu upaya pencegahan utama.</p>'},
                        datasets: [{ label: 'Prevalensi (%)', color: 'rgba(239, 68, 68, 0.7)' }],
                        data: { 'Siantan': [8.1], 'Siantan Selatan': [9.2], 'Siantan Timur': [7.8], 'Palmatak': [10.5], 'Jemaja': [6.5], 'Jemaja Barat': [7.1], 'Jemaja Timur': [6.8], 'Kute Siantan': [11.2], 'Siantan Tengah': [9.8], 'Siantan Utara': [7.5] }
                    }
                 }
            }
        };

        const renderDataContent = (category) => {
            const contentArea = document.getElementById('data-content-area');
            const categoryData = fullDataByCategory[category];
            if (!contentArea || !categoryData) return;

            const indicatorOptions = Object.keys(categoryData.indicators).map(ind => `<option value="${ind}">${ind}</option>`).join('');
            const kecamatanOptions = kecamatanList.map(kec => `<option value="${kec}">${kec}</option>`).join('');

            contentArea.innerHTML = `
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2">
                        <div class="flex flex-col sm:flex-row gap-4 mb-6">
                             <select id="indicator-filter" class="flex-grow bg-slate-800 border border-slate-700 rounded-lg py-2 px-4 focus:ring-2 focus:ring-pink-500 focus:outline-none">
                                ${indicatorOptions}
                            </select>
                            <select id="kecamatan-filter" class="flex-grow bg-slate-800 border border-slate-700 rounded-lg py-2 px-4 focus:ring-2 focus:ring-pink-500 focus:outline-none">
                                <option value="Semua Kecamatan">Semua Kecamatan</option>
                                ${kecamatanOptions}
                            </select>
                        </div>
                        <div class="bg-slate-800/50 rounded-lg p-4 h-96">
                            <h4 id="chart-title" class="text-xl font-bold mb-4 text-center"></h4>
                            <canvas id="data-chart-canvas"></canvas>
                        </div>
                    </div>
                    <div class="lg:col-span-1">
                        <div class="bg-slate-800/50 rounded-xl p-5 h-full">
                            <h5 class="text-lg font-bold flex items-center mb-3"><i class="fas fa-lightbulb mr-3 text-amber-400"></i>Pojok Wawasan</h5>
                            <div id="wawasan-content" class="text-sm text-slate-300 space-y-3"></div>
                            <div class="mt-6 pt-4 border-t border-slate-700">
                                <p class="text-xs text-slate-400 font-semibold">SUMBER DATA:</p>
                                <p id="sumber-data" class="text-xs text-slate-500"></p>
                            </div>
                        </div>
                    </div>
                </div>`;
            
            updateDataViews(category, Object.keys(categoryData.indicators)[0], 'Semua Kecamatan');
        };

        const updateDataViews = (category, indicator, selectedKecamatan) => {
            const indicatorData = fullDataByCategory[category].indicators[indicator];
            if (!indicatorData) return;
            
            const titleEl = document.getElementById('chart-title');
            const wawasanEl = document.getElementById('wawasan-content');
            const sumberEl = document.getElementById('sumber-data');

            wawasanEl.innerHTML = indicatorData.wawasan[selectedKecamatan] || indicatorData.wawasan.default;
            sumberEl.textContent = fullDataByCategory[category].sumber;

            let chartLabels;
            let chartDatasets;

            if (selectedKecamatan === 'Semua Kecamatan') {
                titleEl.textContent = `${indicator} per Kecamatan`;
                chartLabels = kecamatanList;
                chartDatasets = indicatorData.datasets.map((dataset, index) => ({
                    label: dataset.label,
                    data: kecamatanList.map(kec => indicatorData.data[kec][index]),
                    backgroundColor: dataset.color,
                }));
            } else {
                titleEl.textContent = `${indicator} di Kec. ${selectedKecamatan}`;
                const dataForKec = indicatorData.data[selectedKecamatan];
                
                if (indicatorData.datasets.length > 1) {
                    chartLabels = indicatorData.datasets.map(d => d.label);
                    chartDatasets = [{ label: 'Nilai', data: dataForKec, backgroundColor: indicatorData.datasets.map(d => d.color) }];
                } else {
                    chartLabels = [indicatorData.datasets[0].label];
                    chartDatasets = [{ label: indicatorData.datasets[0].label, data: dataForKec, backgroundColor: indicatorData.datasets[0].color }];
                }
            }

            const ctx = document.getElementById('data-chart-canvas').getContext('2d');
            if (dataChart) dataChart.destroy();
            
            dataChart = new Chart(ctx, {
                type: 'bar',
                data: { labels: chartLabels, datasets: chartDatasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, grid: { color: 'rgba(255, 255, 255, 0.1)' }, ticks: { color: '#94a3b8' } },
                        x: { grid: { color: 'rgba(255, 255, 255, 0.05)' }, ticks: { color: '#94a3b8' } }
                    },
                    plugins: { 
                        legend: { 
                            labels: { color: '#e2e8f0' },
                            display: selectedKecamatan === 'Semua Kecamatan' || indicatorData.datasets.length === 1
                        } 
                    }
                }
            });
        };

        const initializeDataSection = () => {
             const filterContainer = document.getElementById('data-filter-container');
            const dataContentArea = document.getElementById('data-content-area');
            if(!filterContainer || !dataContentArea) return;

            renderDataContent('Pendidikan');

            const handleFilterChange = () => {
                const activeCategory = filterContainer.querySelector('.active').dataset.category;
                const selectedIndicator = dataContentArea.querySelector('#indicator-filter').value;
                const selectedKecamatan = dataContentArea.querySelector('#kecamatan-filter').value;
                updateDataViews(activeCategory, selectedIndicator, selectedKecamatan);
            };
            
            filterContainer.addEventListener('click', (e) => {
                if (e.target.matches('.data-filter-btn')) {
                    filterContainer.querySelector('.active').classList.remove('active');
                    e.target.classList.add('active');
                    renderDataContent(e.target.dataset.category);
                }
            });

            dataContentArea.addEventListener('change', (e) => {
                if(e.target.matches('#indicator-filter') || e.target.matches('#kecamatan-filter')) {
                    handleFilterChange();
                }
            });
        };

        // --- INISIALISASI & EVENT LISTENERS ---
        const router = () => { const hash = window.location.hash; if(hash.startsWith('#/kegiatan/')) { renderDetailPage(hash.split('/')[2]); } else { showMainPage(); if (hash) { const targetElement = document.getElementById(hash.substring(1)); if (targetElement) { setTimeout(() => { targetElement.scrollIntoView({ behavior: 'smooth' }); }, 100); } } } };
        const observeSections = () => { const observer = new IntersectionObserver((entries) => { entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('is-visible'); observer.unobserve(entry.target); } }); }, { threshold: 0.1 }); document.querySelectorAll('.fade-in-section:not(.is-visible)').forEach(section => { observer.observe(section); }); };
        
        document.addEventListener('DOMContentLoaded', () => { 
            document.getElementById('copyright-year').textContent = new Date().getFullYear();
            window.addEventListener('hashchange', router); 
            loadStatistik(); 
            loadProgramKerja();
            loadPengurusInti();
            loadOrganisasi(); 
            loadKegiatan(); 
            initializeDataSection();
            observeSections(); 
            router(); 
            document.getElementById('search-kegiatan').addEventListener('input', applyFilters);
            document.getElementById('filter-tahun').addEventListener('change', applyFilters);
            document.getElementById('mobile-menu-button').addEventListener('click', () => document.getElementById('mobile-menu').classList.toggle('hidden'));
            document.body.addEventListener('click', (e) => { if (e.target.closest('#mobile-menu .nav-link') || e.target.closest('a.nav-link[href^="#"]')) { document.getElementById('mobile-menu').classList.add('hidden'); } if (e.target.closest('#detail-content .nav-link')) { e.preventDefault(); window.location.hash = '#'; } if (e.target.closest('a[href="#kontak"]')) { e.preventDefault(); document.getElementById('kontak').scrollIntoView({behavior: 'smooth'}); } });
        });
    </script>
</body>
</html>


